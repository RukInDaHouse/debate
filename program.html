<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" />
	<link rel="stylesheet" href="./css/style.css" />
	<link rel="apple-touch-icon" sizes="180x180" href="./img/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="./img/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="./img/favicon-16x16.png">
	<link rel="manifest" href="./img/site.webmanifest">
	<link rel="mask-icon" href="./img/safari-pinned-tab.svg" color="#5bbad5">
	<meta name="msapplication-TileColor" content="#da532c">
	<meta name="theme-color" content="#ffffff">
	<title>Дебаты</title>
</head>

<body class="demo-1">
	<div class="md:flex flex-col md:flex-row md:min-h-screen w-full max-w-screen-xl mx-auto">
		<script src="./js/go.js"></script>
		<script src="./js/DataInspector.js"></script>
		<div class="p-4 w-full">
			<script src="./js/DoubleTreeLayout.js"></script>
			<script id="code">
			function init() {
				var $ = go.GraphObject.make;
				myDiagram = $(go.Diagram, "myDiagramDiv", {
					"undoManager.isEnabled": true,
					padding: 20,  // extra space when scrolled all the way
            		grid: $(go.Panel, "Grid",  // a simple 10x10 grid
              		$(go.Shape, "LineH", { stroke: "lightgray", strokeWidth: 0.2 }),
              		$(go.Shape, "LineV", { stroke: "lightgray", strokeWidth: 0.2 })
            		),
					layout: $(DoubleTreeLayout, {
						vertical: false,
						directionFunction: function(n) {
							return n.data && n.data.dir !== "left";
						},
						bottomRightOptions: {
							nodeSpacing: 50,
							layerSpacing: 50
						},
						topLeftOptions: {
							nodeSpacing: 50,
							layerSpacing: 50
						},
					})
				});
				myDiagram.addDiagramListener("Modified", function(e) {
					var button = document.getElementById("SaveButton");
					if(button) button.disabled = !myDiagram.isModified;
					var idx = document.title.indexOf("*");
					if(myDiagram.isModified) {
						if(idx < 0) document.title += "*";
					} else {
						if(idx >= 0) document.title = document.title.substr(0, idx);
					}
				});
				
				
				var graygrad = $(go.Brush, "Linear", {
					0: "#800080",
					1: "#800080"
				});
				var purplewhite = $(go.Brush, "Linear", {
					0: "#800080",
					1: "#FFFFFF"
				});
				var bluegrad = $(go.Brush, "Linear", {
					0: "#007fff",
					1: "#007fff"
				});
				var bluewhite = $(go.Brush, "Linear", {
					0: "#007fff",
					1: "#FFFFFF"
				});
				var yellowgrad = $(go.Brush, "Linear", {
					0: "#FEC901",
					1: "#FEA200"
				});
				var lavgrad = $(go.Brush, "Linear", {
					0: "#EF9EFA",
					1: "#A570AD"
				});
				var white = $(go.Brush, "Linear", {
					0: "#FFF",
					1: "#FFF"
				});

				function findHeadShot(key) {
					if(key < 0 || key > 16) return "images/HSnopic.jpg"; // There are only 16 images on the server
					return "images/HS" + key + ".jpg"
				}
				var cxElement = document.getElementById("contextMenu");
				var myContextMenu = $(go.HTMLInfo, {
					show: showContextMenu,
					hide: hideContextMenu
				});
				myDiagram.nodeTemplate = $(go.Node, "Auto", {
					selectionAdorned: true,
					textEditable: true,
					contextMenu: myContextMenu}, new go.Binding("location", "loc", go.Point.parse).makeTwoWay(go.Point.stringify), $(go.Shape, "RoundedRectangle", {
					minSize: new go.Size(120, 21),
				}, new go.Binding("fill", "color")), $(go.TextBlock, {
					stroke: "white",
					font: "17px Helvetica",
					editable: true,
					margin: new go.Margin(30, 30, 30, 30),
					alignment: go.Spot.Left
				}, new go.Binding("text").makeTwoWay()),

				$(go.Panel, "Auto", {alignment: go.Spot.BottomRight},
            	$("Button",
              	{   
					"ButtonBorder.figure": "Circle",
					"ButtonBorder.strokeWidth": 1.5,
					"_buttonFillOver": "white",
					"_buttonStrokeOver": "grey",
					"ButtonBorder.fill": white,
					click: changeLikeColor,
				},
              
              	$(go.Shape,
                { 
					geometryString: "M106 242H46c-9 0-15 6-15 15v240c0 8 6 15 15 15h60c8 0 15-7 15-15V257c0-9-7-15-15-15zM481 281c-3-23-24-39-48-39H316c10-18 15-69 15-89 0-35-28-62-62-62h-13c-8 0-15 7-15 15 0 35-13 98-39 123-17 17-32 24-51 33v226c29 9 67 24 124 24h98c33 0 58-30 45-62a45 45 0 0030-60c32-9 44-49 22-74 8-9 13-21 11-35z",
					desiredSize: new go.Size(12, 12),
					fill: "red",
					margin: 5
					 
				})
            	),),
				$(go.Panel, "Auto", {alignment: go.Spot.BottomLeft},
            	$("Button",
              	{   
					"ButtonBorder.figure": "Circle",
					"ButtonBorder.strokeWidth": 1.5,
					"_buttonFillOver": "white",
					"_buttonStrokeOver": "grey",
					"ButtonBorder.fill": white,
					click: changeDislikeColor,
				},
              
              	$(go.Shape,
                { 
					geometryString: "M406 362h60c9 0 15-7 15-15V106c0-8-6-15-15-15h-60c-8 0-15 7-15 15v241c0 8 7 15 15 15zM31 322c3 23 24 40 48 40h117c-10 17-15 68-15 89 0 34 29 61 63 61h12c8 0 15-7 15-15 0-35 14-97 39-123 17-17 32-23 51-33V115c-29-9-67-24-124-24h-98c-32 0-58 30-45 62a45 45 0 00-30 60c-32 9-44 49-22 74-8 9-13 21-11 35z",
					desiredSize: new go.Size(12, 12),
					fill: "red",
					margin: 5
					 
				})
            	),) );
				myDiagram.nodeTemplate.selectionAdornmentTemplate =
				$(go.Adornment, "Spot",
				$(go.Panel, "Auto",
					$(go.Shape, "Rectangle", { stroke: "dodgerblue", strokeWidth: 2, fill: null }),
					$(go.Placeholder)
				),
				$(go.Panel, "Horizontal",
					{ alignment: go.Spot.Top, alignmentFocus: go.Spot.Bottom },

					$("Button",
					{ 	click: addNodeAndLinkPurple, 
						desiredSize: new go.Size(30, 30), 
						margin: new go.Margin(0, 20, 5, 0),
						"ButtonBorder.figure": "Circle",
						"ButtonBorder.strokeWidth": 3,
						"_buttonFillOver": "white",
						"_buttonStrokeOver": "grey",
					},
					$(go.Shape,
					{ geometryString: "M26 0a26 26 0 100 52 26 26 0 000-52zm13 28H28v11a2 2 0 01-4 0V28H14a2 2 0 010-4h10V14a2 2 0 014 0v10h11a2 2 0 010 4z", stroke: "purple", desiredSize: new go.Size(23, 23) })
					),
					$("Button",
					{ 	click: addNodeAndLinkBlue, 
						desiredSize: new go.Size(30, 30), 
						margin: new go.Margin(0, 0, 5, 20),
						"ButtonBorder.figure": "Circle",
						"ButtonBorder.strokeWidth": 3,
						"_buttonFillOver": "white",
						"_buttonStrokeOver": "grey",
					},
					$(go.Shape,
					{ geometryString: "M26 0a26 26 0 100 52 26 26 0 000-52zm13 28H28v11a2 2 0 01-4 0V28H14a2 2 0 010-4h10V14a2 2 0 014 0v10h11a2 2 0 010 4z", stroke: "blue", desiredSize: new go.Size(23, 23) })
					),

				)
				);
				myDiagram.nodeTemplate.contextMenu =
				$("ContextMenu",
				$("ContextMenuButton",
					$(go.TextBlock, "Удалить ветвь"),
					{
					click: function(e, obj) {
						var node = obj.part.adornedPart;
						if (node !== null) {
						myDiagram.startTransaction("remove dept");
						myDiagram.removeParts(node.findTreeParts());
						myDiagram.commitTransaction("remove dept");
						}
					}
					}
				),
				$("ContextMenuButton",
					$(go.TextBlock, "Перекрасить ветвь (Пурпурный)"),
					{
					click: (e, button) => {
					    const node = button.part.adornedPart;
						if (!node) return;
						e.diagram.model.commit(m => {
        				node.findTreeParts().each(n => m.set(n.data, "color", graygrad));
    				});	
					}
					}
				),
				$("ContextMenuButton",
					$(go.TextBlock, "Перекрасить ветвь (Лазурный)"),
					{
					click: (e, button) => {
					    const node = button.part.adornedPart;
						if (!node) return;
						e.diagram.model.commit(m => {
        				node.findTreeParts().each(n => m.set(n.data, "color", bluegrad));
    				});	
					}
					}
				),
				$("ContextMenuButton",
					$(go.TextBlock, "Перекрасить ветвь (Пурпурный градиент)"),
					{
					click: (e, button) => {
					    const node = button.part.adornedPart;
						if (!node) return;
						e.diagram.model.commit(m => {
        				node.findTreeParts().each(n => m.set(n.data, "color", purplewhite));
    				});	
					}
					}
				),
				$("ContextMenuButton",
					$(go.TextBlock, "Перекрасить ветвь (Лазурный градиент)"),
					{
					click: (e, button) => {
					    const node = button.part.adornedPart;
						if (!node) return;
						e.diagram.model.commit(m => {
        				node.findTreeParts().each(n => m.set(n.data, "color", bluewhite));
    				});	
					}
					}
				),
				$("ContextMenuButton",
					$(go.TextBlock, "Сменить цвет (Пурпурный)"),
					{
					click: function(e, obj) {
						var node = obj.part.adornedPart;
						if (node !== null) {
						myDiagram.startTransaction("remove dept");
						var color = graygrad;
						var diagram = myDiagram;
						changeColor(diagram, color);
						myDiagram.commitTransaction("remove dept");
						}
					}
					}
				),
				$("ContextMenuButton",
					$(go.TextBlock, "Сменить цвет (Лазурный)"),
					{
					click: function(e, obj) {
						var node = obj.part.adornedPart;
						if (node !== null) {
						myDiagram.startTransaction("remove dept");
						var color = bluegrad;
						var diagram = myDiagram;
						changeColor(diagram, color);
						myDiagram.commitTransaction("remove dept");
						}
					}
					}
				),
				$("ContextMenuButton",
					$(go.TextBlock, "Сменить цвет (Белый)"),
					{
					click: function(e, obj) {
						var node = obj.part.adornedPart;
						if (node !== null) {
						myDiagram.startTransaction("remove dept");
						var color = "white";
						var diagram = myDiagram;
						changeColor(diagram, color);
						myDiagram.commitTransaction("remove dept");
						}
					}
					}
				),
				);
				myDiagram.nodeTemplateMap.add("Loading", $(go.Node, "Spot", {
						selectionAdorned: true,
						textEditable: true,
						locationObjectName: "BODY"
					}, new go.Binding("location", "loc", go.Point.parse).makeTwoWay(go.Point.stringify), $(go.Panel, "Auto", {
						name: "BODY"
					}, 
					
					$(go.Shape, "RoundedRectangle", {
						fill: graygrad,
						stroke: "gray",
						minSize: new go.Size(20, 21),
					}, ), $(go.TextBlock, {
						stroke: "white",
						font: "17px Helvetica",
						editable: true,
						margin: new go.Margin(30, 30, 30, 30),
						alignment: go.Spot.Left
					}, new go.Binding("text", "text"))),
					{
					selectionAdornmentTemplate:
						$(go.Adornment, "Spot",
						$(go.Panel, "Auto",
							$(go.Shape, 
							{ 
								fill: null
							}),
							$(go.Placeholder)
						),
						$("Button",
							{ 	click: addNodeAndLinkBlue,
								alignment: go.Spot.TopRight, 
								desiredSize: new go.Size(30, 30), 
								margin: new go.Margin(0, 0, 5, 20),
								"ButtonBorder.figure": "Circle",
								"ButtonBorder.strokeWidth": 3,
								"_buttonFillOver": "white",
								"_buttonStrokeOver": "grey",
							},
						$(go.Shape,
						{ geometryString: "M26 0a26 26 0 100 52 26 26 0 000-52zm13 28H28v11a2 2 0 01-4 0V28H14a2 2 0 010-4h10V14a2 2 0 014 0v10h11a2 2 0 010 4z", stroke: "blue", desiredSize: new go.Size(23, 23) })
						),
						$("Button",
							{ 	click: addNodeAndLinkPurple,
								alignment: go.Spot.BottomRight, 
								desiredSize: new go.Size(30, 30), 
								margin: new go.Margin(0, 0, 5, 20),
								"ButtonBorder.figure": "Circle",
								"ButtonBorder.strokeWidth": 3,
								"_buttonFillOver": "white",
								"_buttonStrokeOver": "grey",
							},
						$(go.Shape,
						{ geometryString: "M26 0a26 26 0 100 52 26 26 0 000-52zm13 28H28v11a2 2 0 01-4 0V28H14a2 2 0 010-4h10V14a2 2 0 014 0v10h11a2 2 0 010 4z", stroke: "purple", desiredSize: new go.Size(23, 23) })
						),
						$("Button",
							{ 	click: addNodeAndLinkLeftBlue,
								alignment: go.Spot.TopLeft, 
								desiredSize: new go.Size(30, 30), 
								margin: new go.Margin(0, 0, 5, 20),
								"ButtonBorder.figure": "Circle",
								"ButtonBorder.strokeWidth": 3,
								"_buttonFillOver": "white",
								"_buttonStrokeOver": "grey",
							},
						$(go.Shape,
						{ geometryString: "M26 0a26 26 0 100 52 26 26 0 000-52zm13 28H28v11a2 2 0 01-4 0V28H14a2 2 0 010-4h10V14a2 2 0 014 0v10h11a2 2 0 010 4z", stroke: "blue", desiredSize: new go.Size(23, 23) })
						),
						$("Button",
							{ 	click: addNodeAndLinkLeftPurple,
								alignment: go.Spot.BottomLeft, 
								desiredSize: new go.Size(30, 30), 
								margin: new go.Margin(0, 0, 5, 20),
								"ButtonBorder.figure": "Circle",
								"ButtonBorder.strokeWidth": 3,
								"_buttonFillOver": "white",
								"_buttonStrokeOver": "grey",
							},
						$(go.Shape,
						{ geometryString: "M26 0a26 26 0 100 52 26 26 0 000-52zm13 28H28v11a2 2 0 01-4 0V28H14a2 2 0 010-4h10V14a2 2 0 014 0v10h11a2 2 0 010 4z", stroke: "purple", desiredSize: new go.Size(23, 23) })
						),
					
						)
					},
));


				myDiagram.contextMenu = myContextMenu;
				cxElement.addEventListener("contextmenu", function(e) {
					e.preventDefault();
					return false;
				}, false);

				function hideCX() {
					if(myDiagram.currentTool instanceof go.ContextMenuTool) {
						myDiagram.currentTool.doCancel();
					}
				}
				myDiagram.linkTemplate = $(go.Link, go.Link.Orthogonal, {
					corner: 5,
					relinkableFrom: true,
					relinkableTo: true
				}, $(go.Shape, {
					strokeWidth: 1.5,
					stroke: "#F5F5F5"
				}));
				load();
				

				function addNodeAndLink(e, obj) {
					var fromNode = obj.part;
					var diagram = fromNode.diagram;
					diagram.startTransaction("Добавить");
					var fromData = fromNode.data;
					var toData = {
						dir: "right",
						text: "Аргумент",
						color: bluegrad
					};
					var model = diagram.model;
					model.addNodeData(toData);
					var linkdata = {
						from: model.getKeyForNodeData(fromData),
						to: model.getKeyForNodeData(toData)
					};
					model.addLinkData(linkdata);
					var newnode = diagram.findNodeForData(toData);
					diagram.select(newnode);
					shiftNodesToEmptySpaces();
					diagram.commitTransaction("Добавить");
				}

				function addNodeAndLinkBlue(e, obj) {
					var fromNode = obj.part;
					var diagram = fromNode.diagram;
					diagram.startTransaction("Добавить");
					var fromData = fromNode.data;
					var toData = {
						dir: "right",
						text: "Аргумент",
						color: bluegrad
					};
					var model = diagram.model;
					model.addNodeData(toData);
					var linkdata = {
						from: model.getKeyForNodeData(fromData),
						to: model.getKeyForNodeData(toData)
					};
					model.addLinkData(linkdata);
					var newnode = diagram.findNodeForData(toData);
					diagram.select(newnode);
					shiftNodesToEmptySpaces();
					diagram.commitTransaction("Добавить");
				}

				function addNodeAndLinkPurple(e, obj) {
					var fromNode = obj.part;
					var diagram = fromNode.diagram;
					diagram.startTransaction("Добавить");
					var fromData = fromNode.data;
					var toData = {
						dir: "right",
						text: "Аргумент",
						color: graygrad
					};
					var model = diagram.model;
					model.addNodeData(toData);
					var linkdata = {
						from: model.getKeyForNodeData(fromData),
						to: model.getKeyForNodeData(toData)
					};
					model.addLinkData(linkdata);
					var newnode = diagram.findNodeForData(toData);
					diagram.select(newnode);
					shiftNodesToEmptySpaces();
					diagram.commitTransaction("Добавить");
				}

				function addNodeAndLinkWhite(e, obj) {
					var fromNode = obj.part;
					var diagram = fromNode.diagram;
					diagram.startTransaction("Добавить");
					var fromData = fromNode.data;
					var toData = {
						dir: "right",
						text: "Аргумент",
						color: white
					};
					var model = diagram.model;
					model.addNodeData(toData);
					var linkdata = {
						from: model.getKeyForNodeData(fromData),
						to: model.getKeyForNodeData(toData)
					};
					model.addLinkData(linkdata);
					var newnode = diagram.findNodeForData(toData);
					diagram.select(newnode);
					shiftNodesToEmptySpaces();
					diagram.commitTransaction("Добавить");
				}

				function addNodeAndLinkLeft(e, obj) {
					var fromNode = obj.part;
					var diagram = fromNode.diagram;
					diagram.startTransaction("Добавить");
					var fromData = fromNode.data;
					var toData = {
						dir: "left",
						text: "Аргумент",
						color: bluegrad
					};
					var model = diagram.model;
					model.addNodeData(toData);
					var linkdata = {
						from: model.getKeyForNodeData(fromData),
						to: model.getKeyForNodeData(toData)
					};
					model.addLinkData(linkdata);
					var newnode = diagram.findNodeForData(toData);
					diagram.select(newnode);
					shiftNodesToEmptySpaces();
					diagram.commitTransaction("Добавить");
				}

				function changeLikeColor(e, button) {
					colorButton = button["_buttonFillNormal"];
					if (colorButton == "#50c878") {
						button["_buttonFillNormal"] = "white";
					}
					else {
						button["_buttonFillNormal"] = "#50c878";
					}
				}

				function changeDislikeColor(e, button) {
					colorButton = button["_buttonFillNormal"];
					if (colorButton == "#ff2e2e") {
						button["_buttonFillNormal"] = "white";
					}
					else {
						button["_buttonFillNormal"] = "#ff2e2e";
					}
				}

				function addNodeAndLinkLeftWhite(e, obj) {
					var fromNode = obj.part;
					var diagram = fromNode.diagram;
					diagram.startTransaction("Добавить");
					var fromData = fromNode.data;
					var toData = {
						dir: "left",
						text: "Аргумент",
						color: white
					};
					var model = diagram.model;
					model.addNodeData(toData);
					var linkdata = {
						from: model.getKeyForNodeData(fromData),
						to: model.getKeyForNodeData(toData)
					};
					model.addLinkData(linkdata);
					var newnode = diagram.findNodeForData(toData);
					diagram.select(newnode);
					shiftNodesToEmptySpaces();
					diagram.commitTransaction("Добавить");
				}
				function addNodeAndLinkLeftBlue(e, obj) {
					var fromNode = obj.part;
					var diagram = fromNode.diagram;
					diagram.startTransaction("Добавить");
					var fromData = fromNode.data;
					var toData = {
						dir: "left",
						text: "Аргумент",
						color: bluegrad
					};
					var model = diagram.model;
					model.addNodeData(toData);
					var linkdata = {
						from: model.getKeyForNodeData(fromData),
						to: model.getKeyForNodeData(toData)
					};
					model.addLinkData(linkdata);
					var newnode = diagram.findNodeForData(toData);
					diagram.select(newnode);
					shiftNodesToEmptySpaces();
					diagram.commitTransaction("Добавить");
				}
				function addNodeAndLinkLeftPurple(e, obj) {
					var fromNode = obj.part;
					var diagram = fromNode.diagram;
					diagram.startTransaction("Добавить");
					var fromData = fromNode.data;
					var toData = {
						dir: "left",
						text: "Аргумент",
						color: graygrad
					};
					var model = diagram.model;
					model.addNodeData(toData);
					var linkdata = {
						from: model.getKeyForNodeData(fromData),
						to: model.getKeyForNodeData(toData)
					};
					model.addLinkData(linkdata);
					var newnode = diagram.findNodeForData(toData);
					diagram.select(newnode);
					shiftNodesToEmptySpaces();
					diagram.commitTransaction("Добавить");
				}
				var OldTarget = null;

				function highlight(port) {
					if(OldTarget !== port) {
						lowlight();
						OldTarget = port;
						port.scale = 1.3;
					}
				}

				function lowlight() {
					if(OldTarget) {
						OldTarget.scale = 1.0;
						OldTarget = null;
					}
				}

				function commonLinkingToolInit(tool) {
					tool.temporaryLink = $(go.Link, {
						layerName: "Tool"
					}, $(go.Shape, {
						stroke: "dodgerblue",
						strokeWidth: 5
					}));
					tool.temporaryFromPort.figure = "Circle";
					tool.temporaryFromPort.stroke = null;
					tool.temporaryFromPort.strokeWidth = 0;
					tool.temporaryToPort.figure = "Circle";
					tool.temporaryToPort.stroke = null;
					tool.temporaryToPort.strokeWidth = 0;
					tool.portTargeted = function(realnode, realport, tempnode, tempport, toend) {
						if(realport === null) {
							lowlight();
						} else if(toend) {
							highlight(realport);
						}
					};
				}
				myDiagram.addDiagramListener("SelectionMoved", shiftNodesToEmptySpaces);

				function shiftNodesToEmptySpaces() {
					myDiagram.selection.each(function(node) {
						if(!(node instanceof go.Node)) return;
						while(true) {
							var exist = myDiagram.findObjectsIn(node.actualBounds, function(obj) {
								return obj.part;
							}, function(part) {
								return part instanceof go.Node && part !== node;
							}, true).first();
							if(exist === null) break;
							node.position = new go.Point(node.actualBounds.x, exist.actualBounds.bottom + 10);
						}
					});
				}
				myDiagram.addDiagramListener("LayoutCompleted", function(e) {
					myDiagram.nodes.each(function(node) {
						if(node.category === "Recycle") return;
						node.minLocation = new go.Point(node.location.x, -Infinity);
					});
				});
				var ltool = myDiagram.toolManager.linkingTool;
				commonLinkingToolInit(ltool);
				ltool.direction = go.LinkingTool.ForwardsOnly;
				var rtool = myDiagram.toolManager.relinkingTool;
				commonLinkingToolInit(rtool);
				document.getElementById('zoomToFit').addEventListener('click', function() {
					myDiagram.commandHandler.zoomToFit();
				});
				document.getElementById('centerRoot').addEventListener('click', function() {
					myDiagram.scale = 1;
					myDiagram.commandHandler.scrollToPart(myDiagram.findNodeForKey(1));
				});

				function showContextMenu(obj, diagram, tool) {
					var cmd = diagram.commandHandler;
					var hasMenuItem = false;

					function maybeShowItem(elt, pred) {
						if(pred) {
							elt.style.display = "block";
							hasMenuItem = true;
						} else {
							elt.style.display = "none";
						}
					}
					maybeShowItem(document.getElementById("delete"), cmd.canDeleteSelection());
					maybeShowItem(document.getElementById("color"), obj !== null);
					if(hasMenuItem) {
						cxElement.classList.add("show-menu");
						var mousePt = diagram.lastInput.viewPoint;
						cxElement.style.left = mousePt.x + 5 + "px";
						cxElement.style.top = mousePt.y + "px";
					}
					window.addEventListener("click", hideCX, true);
				}

				function hideContextMenu() {
					cxElement.classList.remove("show-menu");
					window.removeEventListener("click", hideCX, true);
				}
			}

			function cxcommand(event, val) {

			}

			function deleteNode() {
				myDiagram.commandHandler.deleteSelection();
			}

			function undo() {
				myDiagram.commandHandler.undo();
			}

			function redo() {
				myDiagram.commandHandler.redo();
			}

			function load() {
				myDiagram.model = go.Model.fromJson(document.getElementById("mySavedModel").value);
				var lastkey = 1;
				myDiagram.model.makeUniqueKeyFunction = function(model, data) {
					var k = data.key || lastkey;
					while(model.findNodeDataForKey(k)) k++;
					data.key = lastkey = k;
					return k;
				};
			}

			function save() {
				document.getElementById("mySavedModel").value = myDiagram.model.toJson();
				myDiagram.isModified = false;
			}

			function zoomIn() {
				myDiagram.commandHandler.increaseZoom();
			}

			function zoomOut() {
				myDiagram.commandHandler.decreaseZoom();
			}

			function changeColor(diagram, color) {
				diagram.startTransaction("change color");
				diagram.selection.each(function(node) {
					if(node instanceof go.Node) {
						var data = node.data;
						diagram.model.setDataProperty(data, "color", color);
					}
				});
				diagram.commitTransaction("change color");
			}
			window.addEventListener('DOMContentLoaded', init);
			</script>
		
		</div>
			<div id="sample" class="sample">
				<div style="display: inline-block;">
					<div style="position: relative;">
						<div id="myDiagramDiv" style="background-color: #34343C; border: solid 1px black; height: 700px; width: 100vw; left: 0; padding: 0; margin: 0;"></div>

						<ul id="contextMenu" class="menu">
							<li id="delete" class="menu-item" onclick="cxcommand(event)">Удалить</li>
							<li id="color" class="menu-item">Цвет
								<ul class="menu">
									<li class="menu-item" style="background-color: #9400d3;" onclick="cxcommand(event, 'color')">Фиолетовый</li>
									<li class="menu-item" style="background-color: #007fff;" onclick="cxcommand(event, 'color')">Лазурный</li>
									<li class="menu-item" style="background-color: #ffffff;" onclick="cxcommand(event, 'color')">Белый</li>
								</ul>
							</li>
						</ul>
					</div>
          <div class="panell active__panel" id="panel">
            <div class="main-wrapper">
              <button title="Полная схема" id="zoomToFit">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#fff">
                  <defs/>
                  <g>
                    <path d="M1 0l6 1s1 0 0 0L6 3a100 100 0 005 5v1l-2 2H8L4 6H3L1 7c0 1 0 0 0 0L0 1l1-1zM23 24l-6-1h-1l2-2-1-1-4-4v-1l2-2h1l4 4 1 1 1-2 1 1 1 6-1 1zM0 23l1-6v-1l2 2v-1l5-4h1l2 2v1l-5 4v1l1 1v1l-7 1v-1zM24 1l-1 6h-1l-1-1-1 1-4 4h-1l-2-2V8l4-4 1-1-2-2h1l6-1 1 1z" /> </g>
                </svg>
              </button>
              <button title="Центрирование" id="centerRoot">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" fill="#fff">
                  <defs/>
                  <path d="M11 11l-7-1s-1 0 0 0l1-2-5-5 3-3 5 5 2-1c0-1 0 0 0 0l1 7zM15 15l7 1s1-1 0 0l-1 2a161 161 0 005 5l-3 3-5-5-2 1c0 1 0 0 0 0l-1-7zM11 15l-1 7s0 1 0 0l-2-1-5 5H2l-2-3 5-5-1-2c-1 0 0 0 0 0l7-1zM15 11V4h1l2 1 5-5 3 3-5 5 1 2c1 0 0 0 0 0l-7 1z" /> 
                </svg>
              </button>
              <button title="Сохранить схему" id="SaveButton" onclick="save()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 469.3 469.3" fill="#fff">
                  <defs/>
                  <path d="M466.2 88.5L381 3c-2-2-4.7-3.1-7.6-3.1H42.7A42.7 42.7 0 000 42.7v384a42.7 42.7 0 0042.7 42.6h384a42.7 42.7 0 0042.6-42.6V96c0-2.8-1-5.5-3-7.5zM106.7 21.3h234.6v128c0 11.8-9.5 21.4-21.3 21.4H128a21.4 21.4 0 01-21.3-21.4v-128zM384 448H85.3V256H384v192zm64-21.3c0 11.7-9.6 21.3-21.3 21.3h-21.4V245.3c0-5.9-4.7-10.6-10.6-10.6h-320c-6 0-10.7 4.7-10.7 10.6V448H42.7a21.4 21.4 0 01-21.4-21.3v-384c0-11.8 9.6-21.4 21.4-21.4h42.6v128A42.7 42.7 0 00128 192h192a42.7 42.7 0 0042.7-42.7v-128h6.2l79.1 79.1v326.3z" />
                  <path d="M266.7 149.3h42.6c6 0 10.7-4.7 10.7-10.6V53.3c0-5.9-4.8-10.6-10.7-10.6h-42.6c-6 0-10.7 4.7-10.7 10.6v85.4c0 5.9 4.8 10.6 10.7 10.6zM277.3 64h21.4v64h-21.4V64z" /> 
                </svg>
              </button>
              <button title="Загрузить схему" onclick="load()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 477.9 477.9" fill="#fff">
                  <defs/>
                  <path d="M443.7 307.2a17 17 0 00-17 17v102.5a17 17 0 01-17.1 17H68.3a17 17 0 01-17.1-17V324.3a17 17 0 10-34.1 0v102.4c0 28.2 22.9 51.2 51.2 51.2h341.3c28.3 0 51.2-23 51.2-51.2V324.3a17 17 0 00-17-17.1z" />
                  <path d="M336 295.1a17 17 0 00-23.8 0L256 351.3V17.1a17 17 0 10-34.1 0v334.2l-56.2-56.2a17 17 0 00-24.2 24.2l85.4 85.3a17 17 0 0024.1 0l85.4-85.3a17 17 0 00-.5-24.2z" /> 
                </svg>
              </button>
              <button title="Увеличить масштаб" onclick="zoomIn()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 459.3 459.3" fill="#fff">
                  <defs/>
                  <path d="M459.3 229.7c0 22.2-18 40.2-40.2 40.2H269.8V419a40.2 40.2 0 11-80.3 0V270H40.2A40 40 0 010 229.7c0-22.2 18-40.2 40.2-40.2h149.3V40.2a40.2 40.2 0 0180.4 0v149.3H419c22.2 0 40.2 18 40.2 40.2z" /> 
                </svg>
              </button>
              <button title="Уменьшить масштаб" onclick="zoomOut()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 124 124" fill="#fff">
                  <defs/>
                  <path d="M112 50H12A12 12 0 000 62a12 12 0 0012 12h100a12 12 0 0012-12 12 12 0 00-12-12z" /> 
                </svg>
              </button>
              <button title="Удалить" onclick="deleteNode()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="-40 0 427 427" fill="#fff">
                  <defs/>
                  <path d="M232 155c-5 0-10 4-10 10v189a10 10 0 0020 0V165c0-6-4-10-10-10zm0 0M114 155c-5 0-10 4-10 10v189a10 10 0 0020 0V165c0-6-4-10-10-10zm0 0" />
                  <path d="M28 127v247c0 14 6 28 15 38 9 9 22 15 36 15h189c14 0 26-6 36-15 9-10 14-24 14-38V127a38 38 0 00-9-75h-52V40a39 39 0 00-39-40h-89a39 39 0 00-40 40v12H38a38 38 0 00-10 75zm240 280H79c-17 0-31-15-31-33V128h250v246c0 18-13 33-30 33zM109 40a19 19 0 0120-20h89a19 19 0 0119 20v12H109zM38 72h271a18 18 0 110 36H38a18 18 0 110-36zm0 0" />
                  <path d="M173 155c-5 0-10 4-10 10v189a10 10 0 0020 0V165c0-6-4-10-10-10zm0 0" /> 
                </svg>
              </button>
              <button title="Отменить" onclick="undo()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#fff">
                  <defs/>
                  <path d="M0 128c0 4.6 2 9 5.5 12l128 112a16 16 0 0026.6-12.1v-48h128c79.4 0 144 64.6 144 144s-64.6 144-144 144c-8.8 0-16 7.2-16 16s7.2 16 16 16c123.5 0 224-100.5 224-224s-100.5-224-224-224H160V16c0-6.3-3.6-12-9.4-14.6a16.1 16.1 0 00-17.2 2.5L5.5 116C2 119 0 123.4 0 128z" /> 
                </svg>
              </button>
              <button title="Повторить" onclick="redo()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#fff">
                  <defs/>
                  <path d="M506.5 116L378.5 4A16 16 0 00352 16v48H224A224.2 224.2 0 000 288c0 123.5 100.5 224 224 224a16 16 0 000-32c-79.4 0-144-64.6-144-144s64.6-144 144-144h128v48a16 16 0 0026.5 12l128-112a16 16 0 000-24z" /> 
                </svg>
              </button>
            </div>
            <div>
              <textarea id="mySavedModel" style="width:100%;height:300px">  { 
                "class": "go.GraphLinksModel", "nodeDataArray": [ 
                  { "key":1,
                  "text":"Утверждение", 
                  "category":"Loading"
                  }				  				  
                ]
				 
              } 
            </textarea>
            </div>
          </div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>